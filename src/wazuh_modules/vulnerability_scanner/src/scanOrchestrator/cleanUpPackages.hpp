#ifndef __CLEAN_UP_PACKAGES_HPP
#define __CLEAN_UP_PACKAGES_HPP

#include "chainOfResponsability.hpp"
#include "loggerHelper.h"
#include "scanContext.hpp"
#include "vulnerabilityScanner.hpp"

/**
 * @brief Class in charge to clean up syscollector inventory from database and indexer.
 *
 * @tparam TScanContext scan context type.
 */
template<typename TScanContext = ScanContext>
class TCleanUpPackages final : public AbstractHandler<std::shared_ptr<TScanContext>>
{
private:
    std::shared_ptr<AbstractHandler<std::shared_ptr<ScanContext>>> m_suborchestration;

public:
    // LCOV_EXCL_START
    /**
     * @brief Construct a new clean-up object
     *
     * @param packageDeleOrchestration ScanContext instance.
     */
    explicit TCleanUpPackages(std::shared_ptr<AbstractHandler<std::shared_ptr<ScanContext>>> packageDeleOrchestration)
        : m_suborchestration(std::move(packageDeleOrchestration))
    {
    }
    // LCOV_EXCL_STOP

    /**
     * @brief Handles request and passes control to the next step of the chain.
     *
     * @param data Scan context.
     * @return std::shared_ptr<TScanContext> Abstract handler.
     */
    std::shared_ptr<TScanContext> handleRequest(std::shared_ptr<TScanContext> data) override
    {
        // ToDo
        return AbstractHandler<std::shared_ptr<TScanContext>>::handleRequest(std::move(data));
    }
};

using CleanUpPackages = TCleanUpPackages<>;

#endif // __CLEAN_UP_PACKAGES_HPP
